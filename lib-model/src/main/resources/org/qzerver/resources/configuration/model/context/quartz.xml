<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

    <bean name="quartzSchedulerProperties" class="org.qzerver.system.quartz.QuartzPropertiesFactoryBean">
        <property name="instanceName" value="QZERVER"/>
        <property name="instanceId" value="AUTO"/>
        <property name="schema" value="${app.database.schema}"/>
        <property name="misfireThresholdMs" value="${app.quartz.misfire.threshold.ms}"/>
        <property name="clusterCheckinIntervalMs" value="${app.quartz.cluster.checkin.ms}"/>
        <property name="driverDelegateClass" value="${app.quartz.jdbc.delegate}"/>
        <property name="threadCount" value="${app.quartz.thread.count}"/>
        <property name="threadPriority" value="${app.quartz.thread.priority}"/>
    </bean>

    <bean name="quartzScheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="autoStartup" value="${app.quartz.start.auto}"/>
        <property name="dataSource" ref="dataSource"/>
        <property name="transactionManager" ref="jdbcTransactionManager"/>
        <property name="exposeSchedulerInRepository" value="false"/>
        <property name="overwriteExistingJobs" value="false"/>
        <property name="waitForJobsToCompleteOnShutdown" value="${app.quartz.shutdown.wait}"/>
        <property name="quartzProperties" ref="quartzSchedulerProperties"/>
        <property name="triggers">
            <array>
                <ref bean="exampleTrigger"/>
            </array>
        </property>
    </bean>

    <bean name="quartzSchedulerInitializer" class="org.qzerver.system.quartz.QuartzInitializer">
        <property name="scheduler" ref="quartzScheduler"/>
        <property name="jobListeners">
            <array>
                <bean class="org.qzerver.system.quartz.QzerverJobListener">
                    <property name="executorService" ref="scheduleJobExecutorService"/>
                </bean>
            </array>
        </property>
    </bean>

    <bean name="exampleJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
        <property name="name" value="rtgqwewethweth"/>
        <property name="jobClass" value="org.qzerver.system.quartz.QzerverJob"/>
        <property name="jobDataAsMap">
            <map>
                <entry key="test" value="abcdef"/>
            </map>
        </property>
    </bean>

    <bean id="exampleTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="exampleJob" />
        <property name="cronExpression" value="0 * * * * ?"/>
    </bean>

</beans>